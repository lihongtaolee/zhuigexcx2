(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/sgtool/sgycai/sgycai"],{6545:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.gender=1},e.e1=function(t){e.gender=2})},n=[]},"8fe7":function(e,t,r){"use strict";r.r(t);var a=r("6545"),n=r("c470");for(var i in n)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(i);r("a562");var u=r("828b"),o=Object(u["a"])(n["default"],a["b"],a["c"],!1,null,"66668e26",null,!1,a["a"],void 0);t["default"]=o.exports},"956b":function(e,t,r){"use strict";(function(e,a){var n=r("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r("7eb4")),u=n(r("ee10")),o=n(r("008b")),c=n(r("7aea")),s={data:function(){return{baobaoname:"",gender:1,birthday:"",fatherHeight:"",motherHeight:"",city:[],cityText:"",currentHeight:"",targetHeight:"",boneAge:"",weight:"",measureTime:"",errorMessage:"",isSubmitting:!1,today:(new Date).toISOString().split("T")[0],apiBaseUrl:"https://x.erquhealth.com/wp-json/zhuige/sgtool",userId:null}},methods:{onBirthdayChange:function(e){this.birthday=e.detail.value},onMeasureTimeChange:function(e){this.measureTime=e.detail.value},onCityChange:function(e){this.city=e.detail.value,this.cityText=this.city.join(" ")},checkLoginStatus:function(){var t=this;return(0,u.default)(i.default.mark((function r(){var n;return i.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=o.default.getUser(),n&&n.token||(n=e.getStorageSync("user")),n&&n.token){r.next=5;break}throw a.showModal({title:"温馨提示",content:"请先登录后再录入宝宝档案",showCancel:!1,confirmText:"去登录",success:function(t){t.confirm?e.redirectTo({url:"/pages/user/login/login?type=login&tip=录入宝宝档案"}):c.default.navigateBack()}}),new Error("未登录");case 5:if(n.mobile){r.next=8;break}throw a.showModal({title:"温馨提示",content:"为了完善您的用户信息，请先绑定手机号",showCancel:!1,confirmText:"去绑定",success:function(t){t.confirm?e.redirectTo({url:"/pages/user/login/login?type=mobile&tip=录入宝宝档案"}):c.default.navigateBack()}}),new Error("未绑定手机号");case 8:return t.userId=n.user_id,r.abrupt("return",n);case 10:case"end":return r.stop()}}),r)})))()},submitData:function(){var t=this;return(0,u.default)(i.default.mark((function r(){var a,n,u,o,c,s,f,l;return i.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.errorMessage="",r.prev=1,r.next=4,t.checkLoginStatus();case 4:a=r.sent,r.next=10;break;case 7:return r.prev=7,r.t0=r["catch"](1),r.abrupt("return");case 10:if(t.baobaoname&&t.birthday&&t.currentHeight&&t.fatherHeight&&t.motherHeight&&t.cityText){r.next=13;break}return t.errorMessage="请填写必填项（宝宝姓名、出生日期、实测身高、父母身高、所在城市）",r.abrupt("return");case 13:if(n=parseFloat(t.fatherHeight),u=parseFloat(t.motherHeight),!(n<140||n>220||u<140||u>220)){r.next=18;break}return t.errorMessage="请输入合理的父母身高数值(140-220cm)",r.abrupt("return");case 18:if(o=parseFloat(t.currentHeight),!(o<30||o>200)){r.next=22;break}return t.errorMessage="请输入合理的实测身高数值(30-200cm)",r.abrupt("return");case 22:if(!t.weight){r.next=27;break}if(c=parseFloat(t.weight),!(c<2||c>100)){r.next=27;break}return t.errorMessage="请输入合理的体重数值(2-100kg)",r.abrupt("return");case 27:if(!t.boneAge){r.next=32;break}if(s=parseFloat(t.boneAge),!(s<0||s>18)){r.next=32;break}return t.errorMessage="请输入合理的骨龄数值(0-18岁)",r.abrupt("return");case 32:return t.isSubmitting=!0,r.prev=33,f={user_id:t.userId,baobaoname:t.baobaoname,gender:t.gender,birthday:t.birthday,father_height:t.fatherHeight,mother_height:t.motherHeight,city:t.cityText,current_height:t.currentHeight,target_height:t.targetHeight||null,bone_age:t.boneAge||null,weight:t.weight||null,measure_time:t.measureTime||null},r.next=37,new Promise((function(r,n){e.request({url:"".concat(t.apiBaseUrl,"/save_user_data"),method:"POST",data:f,header:{"content-type":"application/json",Authorization:"Bearer "+a.token},success:function(e){200===e.statusCode?r(e.data):n(new Error("网络请求失败"))},fail:function(e){n(e)}})}));case 37:l=r.sent,0===l.code?(e.showToast({title:"保存成功",icon:"success",duration:2e3}),setTimeout((function(){e.navigateBack()}),2e3)):t.errorMessage=l.msg||"保存失败，请重试",r.next=44;break;case 41:r.prev=41,r.t1=r["catch"](33),t.errorMessage="网络连接失败，请重试";case 44:return r.prev=44,t.isSubmitting=!1,r.finish(44);case 47:case"end":return r.stop()}}),r,null,[[1,7],[33,41,44,47]])})))()}},onShow:function(){this.checkLoginStatus().catch((function(){}))}};t.default=s}).call(this,r("df3c")["default"],r("3223")["default"])},a562:function(e,t,r){"use strict";var a=r("cca9"),n=r.n(a);n.a},c470:function(e,t,r){"use strict";r.r(t);var a=r("956b"),n=r.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(i);t["default"]=n.a},cca9:function(e,t,r){},e240:function(e,t,r){"use strict";(function(e,t){var a=r("47a9");r("c4fa");a(r("3240"));var n=a(r("8fe7"));e.__webpack_require_UNI_MP_PLUGIN__=r,t(n.default)}).call(this,r("3223")["default"],r("df3c")["createPage"])}},[["e240","common/runtime","common/vendor"]]]);