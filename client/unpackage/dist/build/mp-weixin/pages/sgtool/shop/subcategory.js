(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/sgtool/shop/subcategory"],{"03bc":function(o,t,e){"use strict";(function(o,t){var a=e("47a9");e("c4fa");a(e("3240"));var s=a(e("3bb7"));o.__webpack_require_UNI_MP_PLUGIN__=e,t(s.default)}).call(this,e("3223")["default"],e("df3c")["createPage"])},"169e":function(o,t,e){},2745:function(o,t,e){"use strict";e.d(t,"b",(function(){return a})),e.d(t,"c",(function(){return s})),e.d(t,"a",(function(){}));var a=function(){var o=this,t=o.$createElement,e=(o._self._c,o.thirdCategories.length),a=o.__map(o.products,(function(t,e){var a=o.__get_orig(t),s=t.slides&&t.slides.length>0;return{$orig:a,g1:s}})),s=o.products.length;o.$mp.data=Object.assign({},{$root:{g0:e,l0:a,g2:s}})},s=[]},"3bb7":function(o,t,e){"use strict";e.r(t);var a=e("2745"),s=e("681b");for(var n in s)["default"].indexOf(n)<0&&function(o){e.d(t,o,(function(){return s[o]}))}(n);e("9a45");var i=e("828b"),r=Object(i["a"])(s["default"],a["b"],a["c"],!1,null,"5be27056",null,!1,a["a"],void 0);t["default"]=r.exports},"4b9c":function(o,t,e){"use strict";(function(o){var a=e("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(e("af34")),n=(a(e("008b")),a(e("7aea")),a(e("f005")),{components:{ZhuigeNodata:function(){e.e("components/zhuige-nodata").then(function(){return resolve(e("bb50"))}.bind(null,e)).catch(e.oe)}},data:function(){return{subCategoryId:0,thirdCategories:[],currentFilter:0,products:[],page:1,isLoading:!1,hasMore:!0,apiBaseUrl:"https://x.erquhealth.com/wp-json/zhuige-xcx/v1"}},onLoad:function(o){console.log("二级分类详情页面加载"),o.id&&(this.subCategoryId=parseInt(o.id),console.log("二级分类ID:",this.subCategoryId),this.loadThirdCategories(),this.loadProducts())},onReachBottom:function(){this.hasMore&&!this.isLoading&&this.loadMoreProducts()},onPullDownRefresh:function(){this.refreshData()},methods:{loadThirdCategories:function(){var t=this;console.log("开始加载三级分类数据");var e=this.apiBaseUrl+"/sgtool/shop/thirdcategories";console.log("请求URL:",e),console.log("请求参数:",{parent_id:this.subCategoryId}),o.request({url:e,method:"GET",data:{parent_id:this.subCategoryId},success:function(o){console.log("三级分类数据请求成功:",o),200===o.statusCode&&200===o.data.code?(t.thirdCategories=o.data.data,console.log("获取到三级分类数据:",t.thirdCategories)):console.error("三级分类数据请求返回错误:",o.data)},fail:function(t){console.error("三级分类数据请求失败:",t),o.showToast({title:"加载三级分类失败",icon:"none"})}})},loadProducts:function(){var t=this;this.isLoading=!0,this.page=1,this.products=[],console.log("开始加载商品数据");var e=this.apiBaseUrl+"/sgtool/shop/products";console.log("请求URL:",e),console.log("请求参数:",{category_id:this.currentFilter||this.subCategoryId,page:this.page,per_page:10}),o.request({url:e,method:"GET",data:{category_id:this.currentFilter||this.subCategoryId,page:this.page,per_page:10},success:function(e){console.log("商品数据请求成功:",e),200===e.statusCode&&200===e.data.code?(t.products=e.data.data.list,t.hasMore=e.data.data.more,console.log("获取到商品数据:",t.products)):(console.error("商品数据请求返回错误:",e.data),o.showToast({title:e.data.msg||"加载商品失败",icon:"none"}))},fail:function(t){console.error("商品数据请求失败:",t),o.showToast({title:"网络错误",icon:"none"})},complete:function(){t.isLoading=!1,o.stopPullDownRefresh(),console.log("商品数据请求完成")}})},loadMoreProducts:function(){var t=this;if(this.hasMore&&!this.isLoading){this.isLoading=!0,this.page++,console.log("加载更多商品数据");var e=this.apiBaseUrl+"/sgtool/shop/products";console.log("请求参数:",{category_id:this.currentFilter||this.subCategoryId,page:this.page,per_page:10}),o.request({url:e,method:"GET",data:{category_id:this.currentFilter||this.subCategoryId,page:this.page,per_page:10},success:function(e){console.log("加载更多商品数据成功:",e),200===e.statusCode&&200===e.data.code?(t.products=[].concat((0,s.default)(t.products),(0,s.default)(e.data.data.list)),t.hasMore=e.data.data.more):(t.page--,console.error("加载更多商品数据返回错误:",e.data),o.showToast({title:e.data.msg||"加载更多失败",icon:"none"}))},fail:function(e){t.page--,console.error("加载更多商品数据失败:",e),o.showToast({title:"网络错误",icon:"none"})},complete:function(){t.isLoading=!1}})}},switchFilter:function(o){this.currentFilter!==o&&(console.log("切换筛选:",o),this.currentFilter=o,this.loadProducts())},refreshData:function(){this.loadThirdCategories(),this.loadProducts()},navigateToDetail:function(t){t.app_id&&t.path?(console.log("跳转到小程序:",t.app_id,t.path),o.navigateToMiniProgram({appId:t.app_id,path:t.path,success:function(){console.log("跳转成功")},fail:function(t){console.error("跳转失败",t),o.showToast({title:"跳转失败",icon:"none"})}})):(console.warn("商品未配置跳转信息:",t),o.showToast({title:"该商品未配置跳转信息",icon:"none"}))}}});t.default=n}).call(this,e("df3c")["default"])},"681b":function(o,t,e){"use strict";e.r(t);var a=e("4b9c"),s=e.n(a);for(var n in a)["default"].indexOf(n)<0&&function(o){e.d(t,o,(function(){return a[o]}))}(n);t["default"]=s.a},"9a45":function(o,t,e){"use strict";var a=e("169e"),s=e.n(a);s.a}},[["03bc","common/runtime","common/vendor"]]]);