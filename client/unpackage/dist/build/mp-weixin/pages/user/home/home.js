(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/home/home"],{"268d":function(t,e,o){"use strict";o.r(e);var n=o("c7b2"),i=o("eb70");for(var s in i)["default"].indexOf(s)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(s);o("557d");var a=o("828b"),l=Object(a["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=l.exports},"37ca":function(t,e,o){"use strict";(function(t){var n=o("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(o("7aea")),s=n(o("21c8")),a=n(o("f005")),l=n(o("b2e8")),u={components:{ZhuigeTopic:function(){o.e("components/zhuige-topic").then(function(){return resolve(o("1393"))}.bind(null,o)).catch(o.oe)},ZhuigeScrollAd:function(){o.e("components/zhuige-scroll-ad").then(function(){return resolve(o("dc06"))}.bind(null,o)).catch(o.oe)},ZhuigeTab:function(){o.e("components/zhuige-tab").then(function(){return resolve(o("b7cb"))}.bind(null,o)).catch(o.oe)},ZhuigeNodata:function(){o.e("components/zhuige-nodata").then(function(){return resolve(o("bb50"))}.bind(null,o)).catch(o.oe)}},data:function(){return this.user_id=void 0,this.loginReload=!1,this.opt_tab=void 0,this.list=[],this.heights=[],{user:void 0,stat:void 0,rec_ad:void 0,tabs:[],cur_tab:void 0,lists:[[],[]],posts:[],loadMore:"more",loaded:!1,noDataTip:"哇哦，什么也没有",btn_message:!1,nav_opacity:0,statusBarHeight:0}},onLoad:function(e){i.default.addShareScore(e.source),e.user_id&&(this.user_id=e.user_id),e.tab&&(this.opt_tab=e.tab),this.statusBarHeight=t.getSystemInfoSync().statusBarHeight,this.loadData(!0),t.$on("zhuige_event_follow_user",this.onFlollowUser),t.$on("zhuige_event_user_like",this.onUserLike)},onUnload:function(){t.$off("zhuige_event_user_like",this.onUserLike),t.$off("zhuige_event_follow_user",this.onFlollowUser)},onShow:function(){this.loginReload&&this.loadData()},onReachBottom:function(){"more"==this.loadMore&&this.loadPosts(!1)},onPullDownRefresh:function(){this.refresh()},onPageScroll:function(e){this.nav_opacity=(e.scrollTop>255?255:e.scrollTop)/255,e.scrollTop>20?t.setNavigationBarColor({frontColor:"#000000",backgroundColor:"#ffffff"}):t.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:"#ffffff"})},onShareAppMessage:function(){var t="pages/user/home/home?n=n";return this.user_id&&(t+="&user_id="+this.user_id),{title:"个人主页-"+getApp().globalData.appName,path:i.default.addShareSource(t)}},onShareTimeline:function(){return{title:"个人主页-"+getApp().globalData.appName}},methods:{onFlollowUser:function(t){t.from&&"user_home"==t.from?this.loadData():this.loginReload=!0},onUserLike:function(t){this.posts&&this.posts.length>0&&this.posts.forEach((function(e){e.id==t.post_id&&(e.like_count=t.like_count)}))},onImageLoad:function(t){var e=t.detail.height/t.detail.width;e>1.2?e=1.2:e<.8&&(e=.8);var o=345*e;this.lists[t.currentTarget.dataset.a][t.currentTarget.dataset.b].height=o;for(var n=this.lists[t.currentTarget.dataset.a][t.currentTarget.dataset.b].id,i=!1,s=0;s<this.heights.length;s++)if(this.heights[s].id==n){i=!0;break}i||this.heights.push({id:n,height:o}),this.$forceUpdate()},clickBack:function(){i.default.navigateBack()},refresh:function(){this.loadData(),this.loadPosts(!0)},openLink:function(t){i.default.openLink(t)},clickPost:function(t){"1"==t.driect_link_switch?i.default.openLink(t.driect_link):i.default.openLink(t.link+"?id="+t.id)},clickTab:function(t){this.cur_tab=t.id,this.loadPosts(!0)},clickPromotion:function(t){i.default.openLink("/pages/promotion/pay/pay?id="+t)},clickFollowUser:function(){var e=this;l.default.post(a.default.URL("user","follow_user"),{user_id:this.user_id}).then((function(o){0==o.code?t.$emit("zhuige_event_follow_user",{user_id:e.user_id,is_follow:o.data.is_follow,from:"user_home"}):s.default.toast(o.message)}),(function(t){console.log(t)}))},loadData:function(){var e=this,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n={};this.user_id&&(n.user_id=this.user_id),l.default.post(a.default.URL("user","home"),n).then((function(n){e.user=n.data.user,e.stat=n.data.stat,n.data.rec_ad&&(e.rec_ad=n.data.rec_ad),n.data.btn_message&&(e.btn_message=n.data.btn_message),e.tabs=n.data.tabs,e.opt_tab?e.cur_tab=e.opt_tab:e.cur_tab=e.tabs[0].id,o&&e.loadPosts(!0),t.stopPullDownRefresh()}),(function(t){console.log(t)}))},loadPosts:function(t){var e=this;l.default.post(a.default.URL("posts","list_user"),{user_id:this.user_id,tab:this.cur_tab,offset:t?0:this.posts.length}).then((function(o){if("idle"==e.cur_tab){for(var n=o.data.list,i=0;i<n.length;i++)for(var s=0;s<e.heights.length;s++)if(n[i].id==e.heights[s].id){n[i].height=e.heights[s].height;break}if(e.list=t?n:e.list.concat(n),e.loadMore=o.data.more,e.loaded=!0,t)for(var a=0;a<e.lists.length;a++)e.lists[a]=[];for(var l=0;l<e.list.length;l++){for(var u=0,r=0;r<e.lists.length-1;r++)e.lists[r].length>e.lists[r+1].length&&(u=r+1);e.lists[u].push(e.list[l])}e.$forceUpdate()}else e.posts=t?o.data.posts:e.posts.concat(o.data.posts),e.loadMore=o.data.more,e.loaded=!0,e.noDataTip=o.data.tip}),(function(t){console.log(t)}))},onDeleteTopic:function(e){var o=this;t.showModal({title:"提示",content:"真的要删除帖子吗？",success:function(t){t.cancel||l.default.post(a.default.URL("bbs","topic_delete"),{topic_id:e.id}).then((function(t){if(0==t.code){var n=[];o.posts.forEach((function(t){e.id!=t.id&&n.push(t)})),o.posts=n}else s.default.error(t.message)}),(function(t){console.log(t)}))}})},clickDeleteVote:function(e){var o=this;t.showModal({title:"提示",content:"真的要删除投票吗？",success:function(t){t.cancel||l.default.post(a.default.URL("vote","delete"),{vote_id:e}).then((function(t){if(0==t.code){var n=[];o.posts.forEach((function(t){e!=t.id&&n.push(t)})),o.posts=n}else s.default.error(t.message)}),(function(t){console.log(t)}))}})},clickDeleteBusinessCard:function(e){var o=this;t.showModal({title:"提示",content:"真的要删除商家名片吗？",success:function(t){t.cancel||l.default.post(a.default.URL("bcard","delete"),{card_id:e}).then((function(t){if(0==t.code){var n=[];o.posts.forEach((function(t){e!=t.id&&n.push(t)})),o.posts=n}else s.default.error(t.message)}),(function(t){console.log(t)}))}})},clickDeleteIdleGoods:function(e){var o=this;t.showModal({title:"提示",content:"真的要删除闲置物品吗？",success:function(t){t.cancel||l.default.post(a.default.URL("idle","delete"),{goods_id:e}).then((function(t){if(0==t.code){var e=[];o.posts.forEach((function(t){card_id!=t.id&&e.push(t)})),o.posts=e}else s.default.error(t.message)}),(function(t){console.log(t)}))}})}}};e.default=u}).call(this,o("df3c")["default"])},"557d":function(t,e,o){"use strict";var n=o("8f74"),i=o.n(n);i.a},"8f74":function(t,e,o){},a507:function(t,e,o){"use strict";(function(t,e){var n=o("47a9");o("c4fa");n(o("3240"));var i=n(o("268d"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(i.default)}).call(this,o("3223")["default"],o("df3c")["createPage"])},c7b2:function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return n}));var n={uniNavBar:function(){return o.e("uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar").then(o.bind(null,"74ca"))},uniIcons:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(o.bind(null,"ef62"))},uniLoadMore:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more")]).then(o.bind(null,"489a"))},uniRate:function(){return o.e("uni_modules/uni-rate/components/uni-rate/uni-rate").then(o.bind(null,"ad03"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,"idle"==t.cur_tab?t.lists[0].length:null),n="idle"==t.cur_tab&&o>0?t.__map(t.lists,(function(e,o){var n=t.__get_orig(e),i=t.__map(e,(function(e,o){var n=t.__get_orig(e),i=e.tags&&e.tags.length>0;return{$orig:n,g1:i}}));return{$orig:n,l0:i}})):null,i="idle"==t.cur_tab?t.lists[0].length:null,s="idle"!=t.cur_tab?t.posts&&t.posts.length>0:null,a="idle"!=t.cur_tab?t.posts&&t.posts.length>0:null;t.$mp.data=Object.assign({},{$root:{g0:o,l1:n,g2:i,g3:s,g4:a}})},s=[]},eb70:function(t,e,o){"use strict";o.r(e);var n=o("37ca"),i=o.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a}},[["a507","common/runtime","common/vendor"]]]);